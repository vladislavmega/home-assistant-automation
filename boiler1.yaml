alias: –ö–µ—Ä—É–≤–∞–Ω–Ω—è –±–æ–π–ª–µ—Ä–æ–º –∑–∞ –º—ñ—Å—å–∫–æ—é –º–µ—Ä–µ–∂–µ—é (06-10)
description: >
  –í—ñ–∫–Ω–æ —Ä–æ–±–æ—Ç–∏ –±–æ–π–ª–µ—Ä–∞ –∑ 06:00 –¥–æ 10:00.
  –û 06:00 –≤–º–∏–∫–∞—î –±–æ–π–ª–µ—Ä, —è–∫—â–æ —î –º—ñ—Å—å–∫–∞ –º–µ—Ä–µ–∂–∞.
  –£ –≤—ñ–∫–Ω—ñ 06:00‚Äì10:00 –∑–º—ñ–Ω—é—î —Å—Ç–∞–Ω –±–æ–π–ª–µ—Ä–∞ —Ä–∞–∑–æ–º –∑—ñ —Å—Ç–∞–Ω–æ–º –º—ñ—Å—å–∫–æ—ó –º–µ—Ä–µ–∂—ñ.
  –û 10:00 –≤–∏–º–∏–∫–∞—î –±–æ–π–ª–µ—Ä —ñ –¥–∞–ª—ñ –Ω–µ –≤–º–∏–∫–∞—î –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –¥–Ω—è.
mode: single

trigger:
  # –ü–æ—á–∞—Ç–æ–∫ –≤—ñ–∫–Ω–∞
  - id: start_window
    platform: time
    at: "07:00:00"

  # –ó–º—ñ–Ω–∞ —Å—Ç–∞–Ω—É –º—ñ—Å—å–∫–æ—ó –º–µ—Ä–µ–∂—ñ
  - id: grid_change
    platform: state
    entity_id: switch.optika    # üîÅ –ó–ê–ú–Ü–ù–ò –Ω–∞ —Å–≤—ñ–π –¥–∞—Ç—á–∏–∫/—Ä–æ–∑–µ—Ç–∫—É –º—ñ—Å—å–∫–æ—ó –º–µ—Ä–µ–∂—ñ

  # –ö—ñ–Ω–µ—Ü—å –≤—ñ–∫–Ω–∞
  - id: end_window
    platform: time
    at: "11:00:00"

condition: []

action:
  - choose:
      # 1. –û 06:00 ‚Äî —Å—Ç–∞—Ä—Ç –≤—ñ–∫–Ω–∞
      - conditions:
          - condition: trigger
            id: start_window
        sequence:
          - if:
              - condition: state
                entity_id: switch.optika   # üîÅ –ó–ê–ú–Ü–ù–ò
                state: "on"
            then:
              - service: switch.turn_on
                target:
                  entity_id: switch.boiler     # üîÅ –ó–ê–ú–Ü–ù–ò –Ω–∞ —Ä–æ–∑–µ—Ç–∫—É –±–æ–π–ª–µ—Ä–∞
            else:
              - service: switch.turn_off
                target:
                  entity_id: switch.boiler

      # 2. –ó–º—ñ–Ω–∞ —Å—Ç–∞–Ω—É –º—ñ—Å—å–∫–æ—ó –º–µ—Ä–µ–∂—ñ –≤ –º–µ–∂–∞—Ö 06:00‚Äì10:00
      - conditions:
          - condition: trigger
            id: grid_change
          - condition: time
            after: "06:00:00"
            before: "10:00:00"   # —Ç–æ–±—Ç–æ –¥–æ 10:00, 10:00 –≤–∂–µ –Ω–µ –≤—Ö–æ–¥–∏—Ç—å
        sequence:
          - choose:
              # –Ø–∫—â–æ –º–µ—Ä–µ–∂–∞ –∑'—è–≤–∏–ª–∞—Å—å ‚Äî –≤–º–∏–∫–∞—î–º–æ –±–æ–π–ª–µ—Ä
              - conditions:
                  - condition: state
                    entity_id: switch.city_power
                    state: "on"
                sequence:
                  - service: switch.turn_on
                    target:
                      entity_id: switch.boiler

            # –Ø–∫—â–æ –º–µ—Ä–µ–∂—ñ –Ω–µ–º–∞—î ‚Äî –≤–∏–º–∏–∫–∞—î–º–æ –±–æ–π–ª–µ—Ä
            default:
              - service: switch.turn_off
                target:
                  entity_id: switch.boiler

      # 3. –û 10:00 ‚Äî –∂–æ—Ä—Å—Ç–∫–æ –≤–∏–º–∏–∫–∞—î–º–æ –±–æ–π–ª–µ—Ä
      - conditions:
          - condition: trigger
            id: end_window
        sequence:
          - service: switch.turn_off
            target:
              entity_id: switch.boiler
